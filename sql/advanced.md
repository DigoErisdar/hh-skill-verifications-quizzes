## SQL ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å

üèÜ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: 13 –∏–∑ 15.


#### Q1. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ GROUP BY —É–∫–∞–∑–∞–Ω—ã –∫–æ–ª–æ–Ω–∫–∏, –Ω–æ –Ω–µ —É–∫–∞–∑–∞–Ω—ã –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏?

  

- [x] `–∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –∏ –≤ GROUP BY, –∏ –≤ SELECT`

  

#### Q2. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ GROUP BY –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≥—Ä–µ–≥–∏—Ä—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é MAX –∫ –∫–æ–ª–æ–Ω–∫–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è?

  

- [x] `–î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ GROUP BY –≤–µ—Ä–Ω–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É`

  

#### Q3. –ï—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏, –≤ –Ω–∏—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è NULL-–∑–Ω–∞—á–µ–Ω–∏—è. –í –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ ‚Äî –ø—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π NULL, –≤ –ø—Ä–∞–≤–æ–π ‚Äî —Å–µ–º—å. –°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –≤–µ—Ä–Ω–µ—Ç—Å—è —Å NULL –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π?

  

- [x] `INNER ‚Äî 0, LEFT ‚Äî 5, RIGHT ‚Äî 7, FULL ‚Äî 12`

  

#### Q4. –ö–∞–∫–æ–π –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π –≤ CASE?

  

- [x] `–≤–µ—Ä–Ω–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ THEN –ø–µ—Ä–≤–æ–≥–æ —É—Å–ª–æ–≤–∏—è.`

  

#### Q5. –í —ç—Ç–æ–º SQL-–∑–∞–ø—Ä–æ—Å–µ –¥–æ–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫ (–≤ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —ç—Ç–æ–º –æ—à–∏–±–æ–∫ –Ω–µ—Ç). –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏.

  

- [x] `–æ–¥–∏–Ω –∏–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ WHERE –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏; –¥–ª—è –¥–≤—É—Ö –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ—Ç –∞–ª–∏–∞—Å–∞; JOIN –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø–æ–ª—é, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–µ`

  

#### Q6. –£ –≤–∞—Å –µ—Å—Ç—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ test_view. –í—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–µ–≥–æ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü num_purchases. –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ?

  

- [x] `delete materialized view test_view; create or replace materialized_view test_view as select user_id, min(dt) as first_payed, sum(price) as revenue, count(*) as num_purchases group by user_id`

  
  

#### Q7. –£–∫–∞–∂–∏—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–±–µ—Ä–µ—Ç –≤—Å–µ —Ñ–∏–ª—å–º—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ —Å–ª–æ–≤–∞–º–∏ bad, good, angry. –í –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ñ–∏–ª—å–º–æ–≤ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è —ç—Ç–∏ —Å–ª–æ–≤–∞ –≤ —Ä–∞–∑–Ω–æ–º –≤–∏–¥–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö (Badboys) –∏–ª–∏ –≤ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–µ (goodspeed).

  

- [x] `select movie_name from movies where lower(movie_name) like '%bad%' or lower(movie_name) like '%angry%' or lower(movie_name) like '%good%'`

  

#### Q8. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç, –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —É–∫–∞–∑–∞–Ω–∞ –æ—à–∏–±–∫–∞, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –ª–∏–±–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –ª–∏–±–æ –≤–µ—Ä–Ω–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

  

- [x] `regexp_replace –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è CAST`

  

#### Q9. –ö–∞–∫–æ–π –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –µ—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏?

  

- [x] `—Å–∫–æ–ª—å–∑—è—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤, —Ä–∞–∑–Ω–∏—Ü–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏, —Ä–∞–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Å—É–º–º–µ –∑–∞–∫–∞–∑–æ–≤`

  

#### Q10. –í—ã–±–µ—Ä–∏—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å.

  

- [x] `alter table public.table_1 (user_id int, salary float, department_id int)`

  
  

#### Q11. –ö–∞–∫–æ–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –±—É–¥–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, —Ñ–∏–ª—å—Ç—Ä—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã–µ –ø–æ user_id –∏ —Å–æ—Ä—Ç–∏—Ä—É—é—â–∏—Ö –∏—Ö –ø–æ created_at?

  

- [x] `create index payments_user_id_created_at_idx on payments using btree (user_id, created_at);`

  

#### Q12. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤—ã–¥–∞—Ç—å –∏–ª–∏ –æ—Ç–æ–∑–≤–∞—Ç—å –ø—Ä–∞–≤–∞ —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ GRANT, REVOKE.

  

- [x] `CREATE, TRUNCATE, DELETE, TRIGGER`

  

#### Q13. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ EXISTS –∏ ANY –≤ SQL.

  

- [x] `EXISTS –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –µ—Å—Ç—å.`

  

#### Q14. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ INTERSECT, EXCEPT, UNION –∏ —Ç.–¥.

  

- [x] `–°–º–µ–Ω–∞ –ø–æ—Ä—è–¥–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è EXCEPT –ø–æ–º–µ–Ω—è–µ—Ç –≤—ã–≤–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ.`

  

#### Q15. –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è —Ç–æ–ª—å–∫–æ –∫ DDL.

  

- [x] `DROP, ALTER, CREATE, RENAME`
